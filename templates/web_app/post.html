{% extends 'web_app/bbc.html' %}
{% load staticfiles %}

{% block title_block %}
    Post
{% endblock %}
{% block body_block %}
    {#<div class="hero-unit">#}
    {#    <h4>Post {{ post.postId }}</h4>#}
    {##}
    {#    <div class="row">#}
    {#        {% if post %}#}
    {#        <div class="span12">#}
    {#            <center>#}
    {#                <h1>Title</h1>#}
    {#                <img src="{{ post.image.url }}" alt="img">#}
    {#                <div class="row">#}
    {#            </center>#}
    {#            <br><br>#}
    {#        </div>#}
    {#        <div class="span5">#}
    {#            <div class="side">#}
    {#                <div><b>Description:</b><br/>#}
    {#                    {{ post.text }}#}
    {#                </div>#}
    {#            </div>#}
    {#        </div>#}
    {#        <div class="span5">#}
    {#    {% if comments %}#}
    {#        <h3>Comments:</h3>#}
    {#        <ul>#}
    {#            {% for comment in comments %}#}
    {#                <li>#}
    {#                    <div class="side">#}
    {#                        <div>Posted in: {{ comment.date }}</div>#}
    {#                    </div>#}
    {#                    <div class="side">#}
    {#                        <div><b>Text:</b><br/>#}
    {#                            {{ comment.text }}#}
    {#                        </div>#}
    {#                    </div>#}
    {#                    <br>#}
    {#                </li>#}
    {#            {% endfor %}#}
    {#        </ul>#}
    {#    {% else %}#}
    {#        <strong>No comments currently in post.</strong>#}
    {#    {% endif %}#}
    {#    <h4>Comment now:</h4>#}
    {#    <form method='POST' action='' enctype='multipart/form-data'>{% csrf_token %}#}
    {#        {% for field in comment_form %}#}
    {#            % if field.id_for_label != 'id_text' %#}
    {#            <div class="fieldWrapper">#}
    {#                {{ field.errors }}#}
    {#                {{ field.label_tag }} {{ field }}#}
    {#                {% if field.help_text %}#}
    {#                    <p class="help">{{ field.help_text|safe }}</p>#}
    {#                {% endif %}#}
    {#            </div>#}
    {#            % endif %#}
    {#        {% endfor %}#}
    {#        <input type='submit' class='btn btn-default' value='Submit Comment'/>#}
    {#    </form>#}
    {#        </div>#}
    {#    </div>#}
    {#        {% else %}#}
    {#        The specified post does not exist!#}
    {#        {% endif %}#}
    {#</div>#}
    <style>
            .column {
              float: left;
              width: 50%;
            }
            </style>
    <!-- s-content-->
    <section class="s-content s-content--top-padding s-content--narrow">

        {% if post %}
        <div class='row'>
                                <h1 class="entry__header-title display-1" align="center">
                                    {{ post.title }}
                                </h1>
                                <ul class="entry__header-meta" align="center">
                                    <li class="date">{{ post.date }}</li>
                                    <li class="byline">
                                        By
                                        <a href="#0">{{ post.userId.get_username }}</a>
                                    </li>
                                </ul>

        </div>
        <div class="row">
            <div class="column">
                        {% if post.image %}
                            <img src="{{ post.image.url }}" sizes="(max-width: 1000px) 100vw, 1000px" alt="">
                        {% else %}
                            <img src="{% static 'img/thumbs/featured/adopt.jpg' %}"
                                 sizes="(max-width: 1000px) 100vw, 1000px" alt="">
                        {% endif %}      
            </div> <!-- s-entry__main -->
            <div class="column" align="center">
                    <div id="googleMap" style="width:400px;height:400px;"></div>
                    <div id='id_location'>{{ post.location }}</div>
                </div>
        </div>
            <div class="row">
                    <div class="entry__author">
                            {% if post.userId.userprofile.photo %}
                                <img src={{ post.userId.userprofile.photo.url }} alt="">
                            {% endif %}
    
                            <div class="entry__author-about">
                                <h5 class="entry__author-name">
                                    <span>Posted by</span>
                                    <a href="#0">{{ post.userId.get_username }}</a>
                                </h5>
    
                                <div class="entry__author-desc">
                                    <p>
                                        {{ post.text }}
                                    </p>
                                </div>
                            </div>
                        </div>
                </div>
        <div class="row">
                <div id="comments" class="row">
                    <div class="col-full">
                        <h3 class="h2">Comments</h3>
                        {% if comments %}
                            <!-- START commentlist -->
                            <ol>
                                {% for comment in comments %}

                                    <li>

                                        <div class="comment__avatar">
                                            {% if post.userId.userprofile.photo %}
                                                <img class="avatar" src="{{ comment.userId.userprofile.photo.url }}"
                                                     alt=""
                                                     width="50"
                                                     height="50">
                                            {% endif %}
                                        </div>

                                        <div class="comment__content">

                                            <div class="comment__info">
                                                <div class="comment__author">{{ comment.userId.get_username }}</div>

                                                <div class="comment__meta">
                                                    <div class="comment__time">{{ comment.date }}</div>
                                                    {#                                                    <div class="comment__reply">#}
                                                    {#                                                        <a class="comment-reply-link" href="#0">Reply</a>#}
                                                    {#                                                    </div>#}
                                                </div>
                                            </div>

                                            <div class="comment__text">
                                                <p>{{ comment.text }}</p>
                                            </div>

                                        </div>

                                    </li> <!-- end comment-->
                                {% endfor %}


                            </ol>
                            <!-- END commentlist -->
                        {% else %}
                            <strong>No comments currently in this post.</strong>
                        {% endif %}
                    </div> <!-- end col-full -->
                </div> <!-- end comments -->
                    <!-- START respond -->
                    <div id="respond" class="col-full">

                        {#                    {% if comment_added %}#}
                        {#                        <strong>Thank you for commenting!</strong><br/>#}
                        {#                        <a href="{% url 'index' %}">Click here to reurn to the homepage.</a><br/>#}
                        {#                    {% else %}#}

                        <h2 class="h2" align=center>Add Comment</h2>

                        <form method='POST' action='' enctype='multipart/form-data'>{% csrf_token %}
                            {% for field in comment_form %}
                                {#                                {% if field.id_for_label != 'id_text' %}#}
                                <fieldset>

                                    <div class="message form-field">

                                        {{ field.errors }}
                                        {{ field }}
                                        {% if field.help_text %}
                                            <p class="help">{{ field.help_text|safe }}</p>
                                        {% endif %}
                                    </div>

                                </fieldset>
                                {#                                {% endif %}#}
                            {% endfor %}
                            <input name="submit" id="submit"
                                   class="btn btn--primary btn-wide btn--large full-width"
                                   value="Add Comment" type="submit">
                        </form>

                    </div>
                    <!-- END respond-->
        </div>
        {% else %}
            The specified post does not exist!
        {% endif %}

    </section> <!-- end s-content -->
    <script>
            function initMap() {
                var address = (document.getElementById('id_location')).innerHTML;
                // window.alert(address.innerHTML);
                var geocoder = new google.maps.Geocoder();
                var map = new google.maps.Map(document.getElementById('googleMap'), {
                    zoom: 15,
                    scrollwheel: true,
                    // center: { lat: -34.397, lng: 150.644 }
                });
    
                // var address = document.getElementById('address').value;
    
                geocoder.geocode({ 'address': address }, function (results, status) {
                    if (status === 'OK') {
                        map.setCenter(results[0].geometry.location);
                        var marker = new google.maps.Marker({
                            map: map,
                            position: results[0].geometry.location
                        });
                    } else {
                        alert('Geocode was not successful for the following reason: ' + status);
                    }
                })
            }
        </script>
            <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOwO2A_hmXFVDvjhz5Ygv9m-ZvR1_gYcM&libraries=places&callback=initMap">
            </script>
{% endblock %}